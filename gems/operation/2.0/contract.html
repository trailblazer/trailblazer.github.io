<!DOCTYPE html>
<html class="no-js" lang="en">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Trailblazer: Operation Contract</title>
<meta name="description" content="Operation Contract - Trailblazer">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="keywords" content=", ">

<!-- style -->
<link rel="shortcut icon" href="/favicon.ico">
<link href="//fonts.googleapis.com/css?family=Open+Sans:300,%20400,700,800%7CRaleway:400,200,700" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="/css/application.css">

<!-- script -->
<script src="/javascripts/jquery.min.js"></script>
<script src="/javascripts/application.min.js"></script>
<script>
  jQuery(document).ready(function($) {
    $(document).foundation();

    anchors.add("article h2");
    anchors.add("article h3");

    hljs.configure({
      languages: ['ruby', 'haml']
    });

    hljs.initHighlightingOnLoad();

    // $('#code-slider').slick({arrows: true, dots: true});
    $('.carousel').slick({arrows: true, dots: true});
  });
</script>


<meta property="og:title" content="Operation Contract">
<meta property="og:site_name" content="Trailblazer">
<meta property="og:url" content="http://trailblazer.to/gems/operation/2.0/contract.html">
<meta property="og:description" content="">
<meta property="og:image" content="http://trailblazer.to/images/go-trailblazer.jpg">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@apotonick">
<meta name="twitter:title" content="Operation Contract">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="http://trailblazer.to/images/go-trailblazer.jpg">

  </head>
  <body>


  <!--
    <div class="secondary callout" data-closable>
      <strong>TRB JOBS:</strong> Deutschsprachiger Ruby Developer in Hannover - <a href="/inc/jobs.html">Jaaaa!</a>
      <button class="close-button" aria-label="Dismiss alert" type="button" data-close>
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
  -->

      <a class="notice" style="display: block; overflow: hidden; position: relative; width: 100%; padding: 0.6rem 0; background-color: #3b5998;" href="http://fb.me/trailblazer.to">
    <div class="info" style="text-align: center;">
      <h5 style="font-size: 0.9rem; color: white; font-weight: bold;">
        <i class="fa fa-facebook-square" aria-hidden="true" style="font-size: 1.2rem;"></i>
        LIKE US FOR UPDATES + GET A FREE STICKER PACK!
      </h5>
    </div>
  </a>


    <div data-sticky-container class="top-navbar">
  <div class="top-bar sticky" data-sticky data-options="marginTop:0;" style="width:100%">
    <div class="top-bar-title">
      <ul class="menu horizontal">
        <li>
          <a href="/"><img style="height: 25px;" src="/images/logo-top.svg"></a>
        </li>
        <li>
        <span data-responsive-toggle="responsive-menu" data-hide-for="medium">
          <button class="menu-icon" type="button" data-toggle></button>
        </span>
        </li>
      </ul>
    </div>

    <div id="responsive-menu">
      <div class="top-bar-right">
        <ul class="dropdown menu     vertical medium-horizontal" data-dropdown-menu>
          <li><a href="/gems/operation/2.0/release_notes.html">TRB 2.1 IS COMING!</a></li>
          <li><a href="https://trbpro.herokuapp.com/">PREMIUM SUPPORT <img alt="Premium Support" src="/images/pro-white.png"></a></li>
          <li><a href="/newsletter/">NEWSLETTER</a></li>
          <li><a href="https://gitter.im/trailblazer/chat" onclick="trackOutboundLink('https://gitter.im/trailblazer/chat'); return false;">CHAT</a></li>
          <li><a href="/guides">LEARN</a></li>
          <li>
            <a href="#">GEMS</a>
            <ul class="menu vertical">
              <li class=""><a href="/gems/cells">CELLS</a></li>
              <li class=""><a href="/gems/operation/2.0/index.html">OPERATION</a></li>
              <li class=""><a href="/gems/reform">REFORM</a></li>
              <li class=""><a href="/gems/representable">REPRESENTABLE</a></li>
              <li class=""><a href="/gems/roar">ROAR</a></li>
              <li class=""><a href="/gems/formular">FORMULAR</a></li>
              <li class=""><a href="/gems/disposable">DISPOSABLE</a></li>
            </ul>
          </li>
          <li>
            <a href="https://leanpub.com/trailblazer" class="button secondary" onclick="trackOutboundLink('https://leanpub.com/trailblazer'); return false;">GET THE BOOK</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>


    <!-- Hero -->
<div class="hero gems-hero operation2-hero">
  <div class="hero-unit">
    <div class="expanded row">
      <div class="columns">
        <h1 id="project_title">
          Operation
        </h1>
      </div>
    </div>
  </div>
</div>


    <div class="expanded row">
      <div class="medium-9 large-10 medium-push-3 large-push-2 columns">
        <article class="operation2-body">

          
            <header id="doc-header">
  <h1 class="doc-page-title">Operation Contract</h1>
  <span class="doc-last-updated"><i class="fa fa-clock-o" aria-hidden="true"></i> Last updated 10 May 2017</span>

  
    <span class="doc-last-updated">
      <i class="fa fa-diamond" aria-hidden="true"></i>
      <a href="https://github.com/trailblazer/trailblazer">trailblazer</a>

      <a href="/gems/operation/2.0/contract.html">
      <span class="version">v2.0</span>
      </a>

    
      <a href="/gems/operation/1.1/contract.html">
        <span class="version other">v1.1</span>
      </a>
    

    </span>
  

  <hr>

</header>

          

          <div class="row"> <!-- nach doc header -->
            <div class="large-9 columns" id="docs">   <!-- actual docs -->
              <p>A <em>contract</em> is an abstraction to handle validation of arbitrary data or object state. It is a fully self-contained object that is orchestrated by the operation.</p>

<p>The actual validation can be implemented using Reform with <code class="highlighter-rouge">ActiveModel::Validation</code> or dry-validation, or a <a href="#dry-schema"><code class="highlighter-rouge">Dry::Schema</code> directly</a> without Reform.</p>

<p>The <code class="highlighter-rouge">Contract</code> macros helps you defining contracts and assists with instantiating and validating data with those contracts at runtime.</p>

<h2 id="overview-reform" data-magellan-target="overview-reform">Overview: Reform</h2>

<p>Most contracts are <a href="/gems/reform">Reform</a> objects that you can define and validate in the operation. Reform is a fantastic tool for deserializing and validating deeply nested hashes, and then, when valid, writing those to the database using your persistence layer such as ActiveRecord.</p>

<pre><code># app/concepts/song/contract/create.rb
module Song::Contract
  class Create &lt; Reform::Form
    property :title
    property :length

    validates :title,  length: 2..33
    validates :length, numericality: true
  end
end
</code></pre>

<p>The contract then gets hooked into the operation.</p>

<pre><code>class Song::Create &lt; Trailblazer::Operation
  step Model( Song, :new )
  step Contract::Build( constant: Song::Contract::Create )
  step Contract::Validate()
  step Contract::Persist()
end
</code></pre>

<p>As you can see, using contracts consists of five steps.</p>

<ol>
  <li>Define the contract class (or multiple of them) for the operation.</li>
  <li>Plug the contract creation into the operation’s pipe using <code class="highlighter-rouge">Contract::Build</code>.</li>
  <li>Run the contract’s validation for the params using <code class="highlighter-rouge">Contract::Validate</code>.</li>
  <li>If successful, write the sane data to the model(s). This will usually happen in the <code class="highlighter-rouge">Contract::Persist</code> macro.</li>
  <li>After the operation has been run, <a href="#result-object">interpret the result</a>. For instance, a controller calling an operation will render a erroring form for invalid input.</li>
</ol>

<div class="callout">
  
<p>You don’t have to use any of the TRB macros to deal with contracts, and do everything yourself. They are an abstraction that will save code and bugs, and introduce strong conventions. However, feel free to use your own code.</p>

</div>

<p>Here’s what the result would look like after running the <code class="highlighter-rouge">Create</code> operation with invalid data.</p>

<pre><code>result = Song::Create.( title: "A" )
result.success? #=&gt; false
result["contract.default"].errors.messages
  #=&gt; {:title=&gt;["is too short (minimum is 2 characters)"], :length=&gt;["is not a number"]}
</code></pre>

<h2 id="definition" data-magellan-target="definition">Definition</h2>

<p>Trailblazer offers a few different ways to define contract classes and use them in an operation.</p>

<h3 id="definition-explicit">Definition: Explicit</h3>

<p>The preferred way of defining contracts is to use a separate file and class, such as the example below.</p>

<pre><code># app/concepts/song/contract/create.rb
module Song::Contract
  class Create &lt; Reform::Form
    property :title
    property :length

    validates :title,  length: 2..33
    validates :length, numericality: true
  end
end
</code></pre>

<p>This is called <em>explicit contract</em>.</p>

<p>The contract file could be located just anywhere, but it’s clever to follow the Trailblazer conventions.</p>

<p>Using the contract happens via <code class="highlighter-rouge">Contract::Build</code>, and the <code class="highlighter-rouge">:constant</code> option.</p>

<pre><code>class Song::Create &lt; Trailblazer::Operation
  step Model( Song, :new )
  step Contract::Build( constant: Song::Contract::Create )
  step Contract::Validate()
  step Contract::Persist()
end
</code></pre>

<p>Since both operations and contracts grow during development, the completely encapsulated approach of the explicit contract is what we recommend.</p>

<h3 id="definition-inline">Definition: Inline</h3>

<p>Contracts can also be defined in the operation itself.</p>

<pre><code># app/concepts/song/create.rb
class Create &lt; Trailblazer::Operation
  extend Contract::DSL

  contract do
    property :title
    property :length

    validates :title,  presence: true
    validates :length, numericality: true
  end

  step Model( Song, :new )
  step Contract::Build()
  step Contract::Validate()
  step Contract::Persist( method: :sync )
end
</code></pre>

<p>Defining the contract happens via the <code class="highlighter-rouge">contract</code> block. This is called an <em>inline contract</em>. Note that you need to extend the class with the <code class="highlighter-rouge">Contract::DSL</code> module. You don’t have to specify anything in the <code class="highlighter-rouge">Build</code> macro.</p>

<p>While this is nice for a quick example, this usually ends up quite convoluted and we advise you to use the <a href="#definition-explicit">explicit style</a>.</p>

<h2 id="build" data-magellan-target="build">Build</h2>

<p>The <code class="highlighter-rouge">Contract::Build</code> macro helps you to instantiate the contract.
It is both helpful for a complete workflow, or to create the contract, only, without validating it, e.g. when presenting the form.</p>
<pre><code>class Song::New &lt; Trailblazer::Operation
  step Model( Song, :new )
  step Contract::Build( constant: Song::Contract::Create )
end
</code></pre>

<p>This macro will grab the model from <code class="highlighter-rouge">options["model"]</code> and pass it into the contract’s constructor. The contract is then saved in <code class="highlighter-rouge">options["contract.default"]</code>.</p>

<pre><code>result = Song::New.()
result["model"] #=&gt; #&lt;struct Song title=nil, length=nil&gt;
result["contract.default"]
  #=&gt; #&lt;Song::Contract::Create model=#&lt;struct Song title=nil, length=nil&gt;&gt;
</code></pre>

<p>The <code class="highlighter-rouge">Build</code> macro accepts <a href="#name">the <code class="highlighter-rouge">:name</code> option</a> to change the name from <code class="highlighter-rouge">default</code>.</p>

<h2 id="validate" data-magellan-target="validate">Validate</h2>

<p>The <code class="highlighter-rouge">Contract::Validate</code> macro is responsible for validating the incoming params against its contract. That means you have to use <code class="highlighter-rouge">Contract::Build</code> beforehand, or create the contract yourself. The macro will then grab the params and throw then into the contract’s <code class="highlighter-rouge">validate</code> (or <code class="highlighter-rouge">call</code>) method.</p>

<pre><code>class Song::ValidateOnly &lt; Trailblazer::Operation
  step Model( Song, :new )
  step Contract::Build( constant: Song::Contract::Create )
  step Contract::Validate()
end
</code></pre>

<p>Depending on the outcome of the validation, it either stays on the right track, or deviates to left, skipping the remaining steps.</p>

<pre><code>result = Song::ValidateOnly.({}) # empty params
result.success? #=&gt; false
</code></pre>

<p>Note that <code class="highlighter-rouge">Validate</code> really only validates the contract, nothing is written to the model, yet. You need to push data to the model manually, e.g. <a href="#persist">with <code class="highlighter-rouge">Contract::Persist</code></a>.</p>

<pre><code>result = Song::ValidateOnly.({ title: "Rising Force", length: 13 })

result.success? #=&gt; true
result["model"] #=&gt; #&lt;struct Song title=nil, length=nil&gt;
result["contract.default"].title #=&gt; "Rising Force"
</code></pre>

<p><code class="highlighter-rouge">Validate</code> will use <code class="highlighter-rouge">options["params"]</code> as the input. You can change the nesting with <a href="#key">the <code class="highlighter-rouge">:key</code> option</a>.</p>

<div class="callout">
  
<p>Internally, this macro will simply call <code>Form#validate</code> on the Reform object.</p>

<p>Note that Reform comes with sophisticated deserialization semantics for nested forms, it might be worth reading <a href="/gems/reform">a bit about Reform</a> to fully understand what you can do in the <code>Validate</code> step.</p>

</div>

<h2 id="key" data-magellan-target="key">Key</h2>

<p>Per default, <code class="highlighter-rouge">Contract::Validate</code> will use <code class="highlighter-rouge">options["params"]</code> as the data to be validated. Use the <code class="highlighter-rouge">key:</code> option if you want to validate a nested hash from the original params structure.</p>

<pre><code>class Song::Create &lt; Trailblazer::Operation
  step Model( Song, :new )
  step Contract::Build( constant: Song::Contract::Create )
  step Contract::Validate( key: "song" )
  step Contract::Persist( )
end
</code></pre>

<p>This automatically extracts the nested <code class="highlighter-rouge">"song"</code> hash.</p>

<pre><code>result = Song::Create.({ "song" =&gt; { title: "Rising Force", length: 13 } })
result.success? #=&gt; true
</code></pre>

<p>If that key isn’t present in the params hash, the operation fails before the actual validation.</p>

<pre><code>result = Song::Create.({ title: "Rising Force", length: 13 })
result.success? #=&gt; false
</code></pre>

<p>Note that string vs. symbol do matter here since the operation will simply do a hash lookup using the key you provided.</p>

<h2 id="persist" data-magellan-target="persist">Persist</h2>

<p>To push validated data from the contract to the model(s), use <code class="highlighter-rouge">Persist</code>. Like <code class="highlighter-rouge">Validate</code>, this requires a contract to be set up beforehand.</p>

<pre><code>class Song::Create &lt; Trailblazer::Operation
  step Model( Song, :new )
  step Contract::Build( constant: Song::Contract::Create )
  step Contract::Validate()
  step Contract::Persist()
end
</code></pre>

<p>After the step, the contract’s attribute values are written to the model, and the contract will call <code class="highlighter-rouge">save</code> on the model.</p>

<pre><code>result = Song::Create.( title: "Rising Force", length: 13 )
result.success? #=&gt; true
result["model"] #=&gt; #&lt;Song title="Rising Force", length=13&gt;
</code></pre>

<p>You can also configure the <code class="highlighter-rouge">Persist</code> step to call <code class="highlighter-rouge">sync</code> instead of Reform’s <code class="highlighter-rouge">save</code>.</p>

<div class="highlighter-rouge">
<pre class="highlight"><code>step Persist( method: :sync )
</code></pre>
</div>

<p>This will only write the contract’s data to the model without calling <code class="highlighter-rouge">save</code> on it.</p>

<h2 id="name" data-magellan-target="name">Name</h2>

<p>Explicit naming for the contract is possible, too.</p>

<pre><code>class Song::Create &lt; Trailblazer::Operation
  step Model( Song, :new )
  step Contract::Build(    name: "form", constant: Song::Contract::Create )
  step Contract::Validate( name: "form" )
  step Contract::Persist(  name: "form" )
end
</code></pre>

<p>You have to use the <code class="highlighter-rouge">name:</code> option to tell each step what contract to use. The contract and its result will now use your name instead of <code class="highlighter-rouge">default</code>.</p>

<pre><code>result = Song::Create.({ title: "A" })
result["contract.form"].errors.messages #=&gt; {:title=&gt;["is too short (minimum is 2 ch...
</code></pre>

<p>Use this if your operation has multiple contracts.</p>

<h2 id="dry-schema" data-magellan-target="dry-schema">Dry-Schema</h2>

<p>It is possible to use a <a href="dry-rb.org/gems/dry-validation/">Dry::Schema</a> directly as a contract. This is great for stateless, formal validations, e.g. to make sure the params have the right format.</p>

<pre><code>require "dry/validation"
class Create &lt; Trailblazer::Operation
  extend Contract::DSL

  # contract to verify params formally.
  contract "params", (Dry::Validation.Schema do
    required(:id).filled
  end)
  # ...

  step Contract::Validate( name: "params" )
  # ...
end
</code></pre>

<p>Schema validations don’t need a model and hence you don’t have to instantiate them.</p>

<h3 id="dry-guard-schema">Dry: Guard Schema</h3>

<p>Dry’s schemas can even be executed <strong>before</strong> the operation gets instantiated, if you want that. This is called a <em>guard schema</em> and great for a quick formal check. If that fails, the operation won’t be instantiated which will save time massively.</p>

<pre><code>require "dry/validation"
class Delete &lt; Trailblazer::Operation
  extend Contract::DSL

  contract "params", (Dry::Validation.Schema do
    required(:id).filled
  end)

  step Contract::Validate( name: "params" ), before: "operation.new"
  # ...
end
</code></pre>

<p>Use schemas for formal, linear validations. Use Reform forms when there’s a more complex deserialization with nesting and object state happening.</p>

<h3 id="dry-explicit-schema">Dry: Explicit Schema</h3>

<p>As always, you can also use an <em>explicit</em> schema.</p>

<pre><code># app/concepts/comment/contract/params.rb
require "dry/validation"
MySchema = Dry::Validation.Schema do
  required(:id).filled
end
</code></pre>

<p>Just reference the schema constant in the <code class="highlighter-rouge">contract</code> method.</p>

<pre><code># app/concepts/comment/delete.rb
class Delete &lt; Trailblazer::Operation
  extend Contract::DSL
  contract "params", MySchema

  step Contract::Validate( name: "params" ), before: "operation.new"
end
</code></pre>

<h3 id="manual-extraction">Manual Extraction</h3>

<p>You can plug your own complex logic to extract params for validation into the pipe.</p>

<pre><code>class Create &lt; Trailblazer::Operation
  extend Contract::DSL

  contract do
    property :title
  end

  def type
    "evergreen" # this is how you could do polymorphic lookups.
  end

  step Model( Song, :new )
  step Contract::Build()
  step :extract_params!
  step Contract::Validate( skip_extract: true )
  step Contract::Persist( method: :sync )

  def extract_params!(options)
    options["contract.default.params"] = options["params"][type]
  end
end
</code></pre>

<p>Note that you have to set the <code class="highlighter-rouge">self["params.validate"]</code> field in your own step, and - obviously - this has to happen before the actual validation.</p>

<p>Keep in mind that <code class="highlighter-rouge">&amp;</code> will deviate to the left track if your <code class="highlighter-rouge">extract_params!</code> logic returns falsey.</p>

<h2 id="dependency-injection" data-magellan-target="dependency-injection">Dependency Injection</h2>

<p>In fact, the operation doesn’t need any reference to a contract class at all.</p>

<pre><code>class Create &lt; Trailblazer::Operation
  step Model( Song, :new )
  step Contract::Build()
  step Contract::Validate()
  step Contract::Persist( method: :sync )
end
</code></pre>

<p>The contract can be injected when calling the operation.</p>

<p>A prerequisite for that is that the contract class is defined.</p>

<pre><code>class MyContract &lt; Reform::Form
  property :title
  validates :title, length: 2..33
end
</code></pre>

<p>When calling, you now have to provide the default contract class as a dependency.</p>

<pre><code>Create.(
  { title: "Anthony's Song" },
  "contract.default.class" =&gt; MyContract
)
</code></pre>

<p>This will work with any name if you follow <a href="#name">the naming conventions</a>.</p>

<h2 id="manual-build" data-magellan-target="manual-build">Manual Build</h2>

<p>To manually build the contract instance, e.g. to inject the current user, use <code class="highlighter-rouge">builder:</code>.</p>

<pre><code>class Create &lt; Trailblazer::Operation
  extend Contract::DSL

  contract do
    property :title
    property :current_user, virtual: true
    validates :current_user, presence: true
  end

  step Model( Song, :new )
  step Contract::Build( builder: :default_contract! )
  step Contract::Validate()
  step Contract::Persist( method: :sync )

  def default_contract!(options, constant:, model:, **)
    constant.new(model, current_user: self["current_user"])
  end
end
</code></pre>

<p>Note how the contract’s class and the appropriate model are offered as kw arguments. You’re free to ignore these options and use your own assets.</p>

<p>As always, you may also use a proc.</p>

<pre><code>step Contract::Build( builder: -&gt;(options, constant:, model:, **) {
  constant.new(model, current_user: options["current_user"])
})
</code></pre>

<h2 id="result-object" data-magellan-target="result-object">Result Object</h2>

<p>The operation will store the validation result for every contract in its own result object.</p>

<p>The path is <code class="highlighter-rouge">result.contract.#{name}</code>.</p>

<pre><code>result = Create.({ length: "A" })

result["result.contract.default"].success?        #=&gt; false
result["result.contract.default"].errors          #=&gt; Errors object
result["result.contract.default"].errors.messages #=&gt; {:length=&gt;["is not a number"]}
</code></pre>

<p>Each result object responds to <code class="highlighter-rouge">success?</code>, <code class="highlighter-rouge">failure?</code>, and <code class="highlighter-rouge">errors</code>, which is an <code class="highlighter-rouge">Errors</code> object. TODO: design/document Errors. WE ARE CURRENTLY WORKING ON A UNIFIED API FOR ERRORS (FOR DRY AND REFORM).</p>

            </div>

            <div class="large-3 columns sticky-container" data-sticky-container>

              
                <nav class="sticky columns docs-toc-wrap sticky is-anchored is-at-top side-nav" data-sticky data-anchor="docs" data-sticky-on="large" data-margin-top="5">
  
        <ul class="vertical menu" data-magellan id="page-toc">
          <li class="page-toc-heading">ON THIS PAGE:</li>
          <li><a href="#overview-reform">Overview: Reform</a></li>
<li><a href="#definition">Definition</a></li>
<li><a href="#build">Build</a></li>
<li><a href="#validate">Validate</a></li>
<li><a href="#key">Key</a></li>
<li><a href="#persist">Persist</a></li>
<li><a href="#name">Name</a></li>
<li><a href="#dry-schema">Dry-Schema</a></li>
<li><a href="#dependency-injection">Dependency Injection</a></li>
<li><a href="#manual-build">Manual Build</a></li>
<li><a href="#result-object">Result Object</a></li>
        </ul>
      
</nav>

              

            </div>
          </div>
        </article>
      </div>

      <div class="medium-3 large-2 medium-pull-9 large-pull-10 columns">
        <ul id="sidebar" class="side-nav accordion" data-accordion>
  <li class="accordion-item" data-accordion-item>
    <a href="#" class="accordion-title">
      <i class="fa fa-caret-square-o-right" aria-hidden="true"></i>
      <strong>OPERATION</strong>
    </a>
    <div class="accordion-content" data-tab-content>
      <ul class="vertical menu">
        <li><a href="/gems/operation/2.0/index.html">Overview</a></li>
        <li><a href="/gems/operation/2.0/api.html">API</a></li>
        <li><a href="/gems/operation/2.0/contract.html" class="active">Contract</a></li>
        <!--<li><a href="/gems/operation/2.0/representer.html">Representer</a></li>-->
        <li><a href="/gems/operation/2.0/policy.html">Policy</a></li>
        <li><a href="/gems/operation/2.0/representer.html">Representer</a></li>
        <!--<li><a href="/gems/operation/2.0/pipetree.html">Pipetree</a></li>-->
        <li><a href="/gems/operation/2.0/endpoint.html">Endpoint</a></li>
        <li>
<a href="/gems/operation/1.1/index.html">
            <span class="sidebar-info">→ v1.1</span>
          </a>
        </li>
      </ul>
    </div>
  </li>

  <li class="accordion-item" data-accordion-item>
    <a href="#" class="accordion-title">
      <i class="fa fa-caret-square-o-right" aria-hidden="true"></i>
      <strong>TRAILBLAZER</strong>
    </a>
    <div class="accordion-content" data-tab-content>
      <ul class="vertical menu">
        <li><a href="/gems/trailblazer/index.html">Overview</a></li>
        <li><a href="/gems/trailblazer/2.0/rails.html">Rails</a></li>
        <li><a href="/gems/trailblazer/2.0/test.html">Test</a></li>
        <li><a href="/gems/trailblazer/loader.html">Loader</a></li>
        <li><a href="/gems/trailblazer/upgrading-1-to-2.html">Upgrading</a></li>
      </ul>
    </div>
  </li>

  <li class="accordion-item" data-accordion-item>
    <a href="#" class="accordion-title">
      <i class="fa fa-caret-square-o-right" aria-hidden="true"></i>
      <strong>CELLS</strong>
    </a>
    <div class="accordion-content" data-tab-content>
      <ul class="vertical menu">
        <li><a href="/gems/cells">Overview</a></li>
        <li><a href="/gems/cells/getting-started.html">Getting Started<span class="sidebar-info">NEW</span></a></li>
        <li><a href="/gems/cells/api.html">API</a></li>
        <li><a href="/gems/cells/trailblazer.html">Trailblazer::Cell</a></li>
        <li><a href="/gems/cells/testing.html">Testing</a></li>
        <li><a href="/gems/cells/render.html">Rendering</a></li>
        <li><a href="/gems/cells/rails.html">Rails</a></li>
        <li><a href="/gems/cells/templates.html">Templates</a></li>
        <li><a href="/gems/cells/troubleshooting.html">Troubleshooting</a></li>
      </ul>
    </div>
  </li>

  <li class="accordion-item" data-accordion-item>
    <a href="#" class="accordion-title">
      <i class="fa fa-caret-square-o-right" aria-hidden="true"></i>
      <strong>REFORM</strong>
    </a>
    <div class="accordion-content" data-tab-content>
      <ul class="vertical menu">
        <li><a href="/gems/reform/index.html">Overview</a></li>
        <li><a href="/gems/reform/api.html">API</a></li>
        <li><a href="/gems/reform/options.html">Options</a></li>
        <li><a href="/gems/reform/data-types.html">Data Types</a></li>
        <li><a href="/gems/reform/populator.html">Populator</a></li>
        <li><a href="/gems/reform/prepopulator.html">Prepopulator</a></li>
        <li><a href="/gems/reform/validation.html">Validation</a></li>
        <li><a href="/gems/reform/rails.html">Rails</a></li>
        <li><a href="/gems/reform/debugging.html">Debugging</a></li>
        <li><a href="/gems/reform/upgrading-guide.html">Upgrading Guide</a></li>
      </ul>
    </div>
  </li>

  <li class="accordion-item" data-accordion-item>
    <a href="#" class="accordion-title">
      <i class="fa fa-caret-square-o-right" aria-hidden="true"></i>
      <strong>REPRESENTABLE</strong>
    </a>
    <div class="accordion-content" data-tab-content>
      <ul class="vertical menu">
        <li><a href="/gems/representable">Overview</a></li>
        <li><a href="/gems/representable/getting-started.html">Getting Started</a></li>
        <li><a href="/gems/representable/3.0/api.html">API</a></li>
        <li><a href="/gems/representable/3.0/function-api.html">Function API</a></li>
        <li><a href="/gems/representable/3.0/populator.html">Populator</a></li>
        <!--<li><a href="/gems/representable/architecture.html">Architecture</a></li>-->
        <li><a href="/gems/representable/3.0/xml.html">XML</a></li>
        <li><a href="/gems/representable/3.0/yaml.html">YAML</a></li>
        <li><a href="/gems/representable/upgrading-guide.html">Upgrading Guide</a></li>
      </ul>
    </div>
  </li>

  <li class="accordion-item" data-accordion-item>
    <a href="#" class="accordion-title">
      <i class="fa fa-caret-square-o-right" aria-hidden="true"></i>
      <strong>ROAR</strong>
    </a>
    <div class="accordion-content" data-tab-content>
      <ul class="vertical menu">
        <li><a href="/gems/roar/index.html">Overview</a></li>
        <li><a href="/gems/roar/jsonapi.html">JSON API</a></li>
      </ul>
    </div>
  </li>

  <li class="accordion-item" data-accordion-item>
    <a href="#" class="accordion-title">
      <i class="fa fa-caret-square-o-right" aria-hidden="true"></i>
      <strong>FORMULAR</strong>
    </a>
    <div class="accordion-content" data-tab-content>
      <ul class="vertical menu">
        <!-- <li><a href="/gems/formular/index.html">Overview</a></li> -->
        <li><a href="/gems/formular/bootstrap.html">Bootstrap</a></li>
      </ul>
    </div>
  </li>

  <li class="accordion-item" data-accordion-item>
    <a href="#" class="accordion-title">
      <i class="fa fa-caret-square-o-right" aria-hidden="true"></i>
      <strong>DISPOSABLE</strong>
    </a>
    <div class="accordion-content" data-tab-content>
      <ul class="vertical menu">
        <li><a href="/gems/disposable/index.html">Overview</a></li>
        <li><a href="/gems/disposable/api.html">API</a></li>
        <li><a href="/gems/disposable/default.html">Default</a></li>
        <li><a href="/gems/disposable/callback.html">Callback</a></li>
      </ul>
    </div>
  </li>

  <li class="accordion-item" data-accordion-item>
    <a href="#" class="accordion-title">
      <i class="fa fa-caret-square-o-right" aria-hidden="true"></i>
      <strong>GUIDES</strong>
    </a>
    <div class="accordion-content" data-tab-content>
      <ul class="vertical menu">
        <li><a href="/guides/index.html">Overview</a></li>
        <li><a href="/guides/trailblazer/2.0/01-operation-basics.html">01 - Operation Basics</a></li>
        <li><a href="/guides/trailblazer/2.0/02-trailblazer-basics.html">02 - Trailblazer Basics</a></li>
        <li><a href="/guides/trailblazer/2.0/03-rails-basics.html">03 - Rails Basics</a></li>
      </ul>
    </div>
  </li>

  <!--
  <li class="accordion-item" data-accordion-item>
    <a href="#" class="accordion-title">
      <i class="fa fa-caret-square-o-right" aria-hidden="true"></i>
      <strong></strong>
    </a>
    <div class="accordion-content" data-tab-content>
      <ul class="vertical menu">
        <li><a href="">Overview</a></li>
        
      </ul>
    </div>
  </li>

  -->
</ul>

<script>
  (function (document, window) {
    var $sidebar = $('#sidebar');
    var $items = $sidebar.find('.accordion-item')
    var currentPath = window.location.pathname;

    $items.each(function (i, elem) {
      var $elem = $(elem);
      var linkHref = $elem
        .find('.accordion-content li:first-child a')
        .attr('href')
        .replace('index.html', '');

      if (currentPath.indexOf(linkHref) !== -1) {
        $elem.addClass('is-active')
      }
    })
  })(document, window);
</script>

      </div>
    </div>


    <section class="top-footer">
  <div class="row">
    <div class="columns medium-6">
      <h3>Newsletter</h3>
      <p>
        Stay on top of what’s happening in Trailblazer.
      </p>
        <div class="row">
          <div id="mc_embed_signup">
            <form action="//trailblazerb.us8.list-manage.com/subscribe/post?u=bbe5021ab6fbdc94a16f0d036&amp;id=a69f6e4652" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>

              <div class="columns large-9 medium-12 ">
                <div class="row collapse prefix-radius">
                  <div class="small-8 medium-7 large-8 columns">
                    <div id="mc_embed_signup_scroll">
                      <div class="mc-field-group">
                        <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" placeholder="youremail@trailblazer.to">
                      </div>
                      <div id="mce-responses" class="clear">
                        <div class="response" id="mce-error-response" style="display:none"></div>
                        <div class="response" id="mce-success-response" style="display:none"></div>
                      </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
                      <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_bbe5021ab6fbdc94a16f0d036_a69f6e4652" tabindex="-1" value=""></div>

                    </div>
                  </div>
                  <div class="small-4 medium-5 large-4 columns">
                    <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button postfix secondary">
                  </div>
                </div>
              </div>
            </form>
          </div>
          <script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js"></script><script type="text/javascript">(function($) {window.fnames = new Array(); window.ftypes = new Array();fnames[0]='EMAIL';ftypes[0]='email';fnames[1]='FNAME';ftypes[1]='text';fnames[2]='LNAME';ftypes[2]='text';}(jQuery));var $mcj = jQuery.noConflict(true);</script>
        </div>
      <p>
        And check out the <a href="/newsletter/">archive of newsletters</a>!
      </p>


    </div>
    <div class="columns medium-6">
      <h3>The Book</h3>
      <p>Learn how to build a Rails app with Trailblazer, step-by-step.</p>
      <a href="https://leanpub.com/trailblazer" class="button secondary">Get the book!</a>
    </div>
  </div>
</section>

<footer>
  <div class="row">
    <div class="columns medium-4">
      <div class="logo-box">
        <a href="/"><img src="/images/icon_trb.png">
        </a>
      </div>
    </div>
    <div class="columns medium-8">
      <div class="row">
        <div class="columns medium-6">
          <h4>
            Trailblazer
          </h4>
          <ul class="no-bullet">
            <li><a href="https://gitter.im/trailblazer/chat">Gitter chat</a></li>
            <li><a href="https://leanpub.com/trailblazer" onclick="trackOutboundLink('https://leanpub.com/trailblazer'); return false;">The book</a></li>
          </ul>
        </div>
        <div class="columns medium-6">
          <h4>
            Follow Us
          </h4>
          <ul class="menu">
            <li>
              <a href="https://github.com/trailblazer">
                <i class="footer-icon github-icon"></i>
              </a>
            </li>
            <li>
              <a href="https://twitter.com/trailblazer.to">
                <i class="footer-icon twitter-icon"></i>
              </a>
            </li>
            <li>
              <a href="https://facebook.com/trailblazer.to">
                <i class="footer-icon facebook-icon"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
      <p class="copyright">
        Trailblazer is created by <a href="http://www.synergysoft.com.sg/">Synergy Software Solutions Pte Ltd,</a> and awesome friends.
      </p>
      <p class="copyright">
        Site designed and handcoded with love by <a href="https://twitter.com/noeliacabane">Noelia Cabane</a>
      </p>
    </div>
  </div>
</footer>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-69514939-1', 'auto');
  ga('send', 'pageview');

  /**
  * Function that tracks a click on an outbound link in Analytics.
  * This function takes a valid URL string as an argument, and uses that URL string
  * as the event label. Setting the transport method to 'beacon' lets the hit be sent
  * using 'navigator.sendBeacon' in browser that support it.
  */
  var trackOutboundLink = function(url) {
     ga('send', 'event', 'outbound', 'click', url, {
       'transport': 'beacon',
       'hitCallback': function(){document.location = url;}
     });
  }
</script>



  </body>
</html>
